# ML-Guided LMCT Catalysis for Light-Driven Deracemization of Atropisomers

This repository contains the code accompanying the article *Machine Learning–Guided LMCT Catalysis for Light-Driven Deracemization of Atropisomers*. It implements a machine learning pipeline for predicting the enantiomeric excess (ee) values of BINOL-ligand combinations in light-driven deracemization reactions. Key components include descriptor generation from DFT calculations, active learning for iterative model improvement, and ligand recommendations for novel BINOL scaffolds.

## Features

- **Descriptor Generation**: Compute physicochemical descriptors for BINOL-ligand complexes using DFT-derived data.
- **Active Learning**: Iteratively refine the ML model by selecting high-uncertainty samples for labeling.
- **Model Training and Validation**: Train a predictive model for ee values with 5-fold cross-validation.
- **Ligand Recommendation**: Generate recommendations for optimal ligands paired with new BINOL derivatives.
- **Visualization Tools**: Scripts for generating publication-quality figures from molecular structures and energies.

## Environment Setup

To set up the development environment, we recommend using Conda for dependency management. Create a new environment named `binol-ml-env` and install the required packages.

1. Create the Conda environment:

   ```
   conda create -n binol-ml-env python=3.9
   conda activate binol-ml-env
   ```
2. Install dependencies from `requirements.txt`:

   ```
   pip install -r requirements.txt
   ```

This environment includes essential libraries for data processing (e.g., Pandas, NumPy), machine learning (e.g., scikit-learn), and cheminformatics (e.g., RDKit for descriptor calculations).

## Usage

The project is structured around Jupyter notebooks for reproducibility. Run them in sequence to replicate the workflow.

- **1_DFT&Descriptors.ipynb**: Builds descriptors for the training dataset using DFT outputs. This notebook loads Gaussian log files, extracts geometric and electronic features, and computes custom physicochemical descriptors for BINOL-ligand pairs.
- **2_ActiveLearning.ipynb**: Implements the active learning loop. It trains an initial model, queries uncertain points for DFT evaluation, and iterates to expand the dataset. The final iteration (Iteration 2) is saved in `Data/Iteration_2/`.
- **3_Modeling.ipynb**: Performs 5-fold cross-validation on the trained model, evaluates performance metrics (e.g., RMSE, R²), and generates plots for model diagnostics.
- **4_Draw_Molecules.ipynb**: Renders molecular structures and energy diagrams for figures in the article, including reaction schemes and recommended complexes.

To run the notebooks:

```
jupyter notebook
```

Ensure you have Jupyter installed (included in `requirements.txt`).

## Data Directory

The `Data/` folder contains processed and raw data from the study:

- **`Data/DFT/`**: DFT-calculated descriptors and energies for the initial BINOL-ligand dataset. Includes Gaussian output files and summarized feature tables.
- **`Data/Iteration_2/`**: Outputs from the active learning iterations, including selected queries, updated datasets, and model checkpoints for each step.
- **`Data/Recommended/`**: Ligand recommendations generated by the final model for a set of novel BINOL scaffolds. Detailed results and analysis are provided in the accompanying article.
- **`Data/Binol_Cu_Box/`**: Thermodynamic energy data for the R-BINOL-Cu-Box and S-BINOL-Cu-Box complexes, as featured in Figure 5 of the article.

## DFTStructureGenerator Module

The `DFTStructureGenerator/` directory provides utility scripts and functions for descriptor engineering and visualization:

- **Gaussian Input/Output Handling**: Scripts to automate the generation of Gaussian input files for BINOL-ligand optimizations and parse output logs for energies, geometries, and orbitals.
- **Descriptor Functions**: Core utilities for computing a wide range of physicochemical descriptors (e.g., steric, electronic, and hydrogen-bonding features) from molecular structures. These are used extensively in `1_DFT&Descriptors.ipynb`.
- **Plotting Tools**: Helper functions for creating 2D/3D molecular visualizations, energy profiles, and ee prediction scatter plots, compatible with Matplotlib and RDKit.

For advanced usage, import functions like `generate_descriptors(mol)` or `parse_gaussian_log(log_file)` directly in your scripts.

## Citation

If you use this code in your research, please cite the original article:

> Liu L et al. Machine Learning–Guided LMCT Catalysis for Light-Driven Deracemization of Atropisomers. *Journal Name*, Year. (In Submitting)

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

# ML-Guided LMCT Catalysis for Light-Driven Deracemization of Atropisomers（中文翻译）

本仓库包含了文章《Machine Learning–Guided LMCT Catalysis for Light-Driven Deracemization of Atropisomers》的配套代码。它实现了用于预测光驱动消旋化反应中BINOL-配体组合对映体过量（ee）值的机器学习管道。主要组件包括基于DFT计算的描述符生成、用于迭代模型改进的主动学习，以及针对新型BINOL骨架的配体推荐。

## 功能特性

- **描述符生成**：使用DFT衍生的数据计算BINOL-配体络合物的物理化学描述符。
- **主动学习**：通过选择高不确定性样本进行标注，迭代优化ML模型。
- **模型训练与验证**：训练ee值预测模型，并进行5折交叉验证。
- **配体推荐**：为新型BINOL衍生物生成最优配体配对推荐。
- **可视化工具**：用于从分子结构和能量生成出版级图表的脚本。

## 环境配置

为了设置开发环境，我们推荐使用Conda进行依赖管理。创建一个名为 `binol-ml-env`的新环境，并安装所需的包。

1. 创建Conda环境：

   ```
   conda create -n binol-ml-env python=3.9
   conda activate binol-ml-env
   ```
2. 从 `requirements.txt`安装依赖：

   ```
   pip install -r requirements.txt
   ```

此环境包括数据处理（例如Pandas、NumPy）、机器学习（例如scikit-learn）和化学信息学（例如RDKit用于描述符计算）的必需库。

## 使用方法

项目围绕Jupyter笔记本构建，以确保可重复性。请按顺序运行它们来复制工作流程。

- **1_DFT&Descriptors.ipynb**：使用DFT输出构建训练数据集的描述符。该笔记本加载Gaussian日志文件，提取几何和电子特征，并计算BINOL-配体对的自定义物理化学描述符。
- **2_ActiveLearning.ipynb**：实现主动学习循环。它训练初始模型，查询不确定点进行DFT评估，并迭代扩展数据集。最终迭代（Iteration 2）保存在 `Data/Iteration_2/`中。
- **3_Modeling.ipynb**：对训练模型进行5折交叉验证，评估性能指标（例如RMSE、R²），并生成模型诊断图表。
- **4_Draw_Molecules.ipynb**：渲染分子结构和能量图，用于文章中的图表，包括反应方案和推荐络合物。

运行笔记本：

```
jupyter notebook
```

确保已安装Jupyter（包含在 `requirements.txt`中）。

## 数据目录

`Data/`文件夹包含研究中的处理和原始数据：

- **`Data/DFT/`**：初始BINOL-配体数据集的DFT计算描述符和能量。包括Gaussian输出文件和汇总特征表。
- **`Data/Iteration_2/`**：主动学习迭代的输出，包括选定查询、更新数据集和每个步骤的模型检查点。
- **`Data/Recommended/`**：最终模型针对一组新型BINOL骨架生成的配体推荐。详细结果和分析见配套文章。
- **`Data/Binol_Cu_Box/`**：文章Figure 5中R-BINOL-Cu-Box和S-BINOL-Cu-Box络合物的热力学能量数据。

## DFTStructureGenerator 模块

`DFTStructureGenerator/`目录提供了描述符工程和可视化的实用脚本和函数：

- **Gaussian输入/输出处理**：自动化生成BINOL-配体优化的Gaussian输入文件，并解析输出日志以提取能量、几何和轨道。
- **描述符函数**：从分子结构计算广泛物理化学描述符的核心工具（例如空间、电子和氢键特征）。这些在 `1_DFT&Descriptors.ipynb`中广泛使用。
- **绘图工具**：用于创建2D/3D分子可视化、能量轮廓和ee预测散点图的辅助函数，与Matplotlib和RDKit兼容。

对于高级使用，可直接在脚本中导入函数，如 `generate_descriptors(mol)`或 `parse_gaussian_log(log_file)`。

## 引用

如果您在研究中使用此代码，请引用原文章：

> [作者]。Machine Learning–Guided LMCT Catalysis for Light-Driven Deracemization of Atropisomers。*期刊名称*，年份。

## 许可

本项目采用MIT许可 - 详见[LICENSE](LICENSE)文件。
